<?php

// Connecting to the Database
$servername = "localhost";
$username = "root";
$password = "";
$database = "user_registration";

// Create a connection
$conn = mysqli_connect($servername, $username, $password, $database);

// Die if connection was not successful
if (!$conn){
    die("Sorry we failed to connect: ". mysqli_connect_error());
}

// Safe input handling to prevent SQL injection
// $uname = mysqli_real_escape_string($conn, trim($_POST['username']));
// $pass = mysqli_real_escape_string($conn, trim($_POST['password']));


// unsafe, allows sqli and js injections 
$uname = $_POST['username'];
$pass = md5($_POST['password']);


?>

<table border="2px">
 <tr>
   <th> Username </th>
   <th> Password </th>
 </tr>

<?php

// Secure query to prevent SQL injection
$q = "SELECT * FROM login WHERE username='$uname' AND password='$pass'";
echo "QUERY IS ", $q;
$query = mysqli_query($conn, $q);

if (mysqli_num_rows($query) > 0) {
    while ($res = mysqli_fetch_array($query)) {
        ?>
        <tr class="text-center">
            <td><?php echo $res['username']; ?></td>
            <td><?php echo $res['password']; ?></td>
        </tr>
        <?php
    }
} else {
    echo "<b>Login failed. Invalid Username or Password</b>";
}
?>

</table>

<form action="..\jsi\search.html">
    <p></p>
    <input type="submit" value="Proceed to Search Page">
</form>

