<!DOCTYPE html>
<html>
    <head>
        <title>User Dashboard</title>
        <script>
            if (document.readyState == 'loading') {
                document.addEventListener('DOMContentLoaded', ready);
            } else {
                ready();
            }

            function getCookie(name) {
                let cookieArr = document.cookie.split(";");
                for (let i = 0; i < cookieArr.length; i++) {
                    let cookiePair = cookieArr[i].split("=");
                    if (name == cookiePair[0].trim()) {
                        return decodeURIComponent(cookiePair[1]);
                    }
                }
                return null;
            }

            function ready() {
                var query = new URL(window.location).searchParams.get('query');
                document.getElementById('query-input').value = query;
                document.getElementById('query-output').innerHTML= query;  // UNSAFE
                // document.getElementById('query-output').innerText= query; // SAFE- DOESNT EXECUTE INJECTED CODE IN SEARCH BOX
                
                var username = getCookie("username");
                var password = getCookie("password");
                if (username && password) {
                    console.log("Username:", username);
                    console.log("Password:", password);
                }
            }
        </script>
    </head>
    <body>
      <h1 class="search-form-header">Post-Login</h1>
      <form class="search-form" autocomplete="off">
          <input class="search-input" id="query-input" type="text" name="query" />
          <button class="search-button" type="submit" role="button">Search</button>
      </form>
      <h3 class="search-query">You Queried: <span id="query-output" class="query"></span></h3>
    </body>
</html>
